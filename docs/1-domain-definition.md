# pkt-todolist 도메인 정의서

**버전**: 1.1
**최종 수정일**: 2025-11-25
**상태**: 개정

## 변경 이력

| 버전 | 날짜       | 변경 내용                                                                          | 작성자 |
| ---- | ---------- | ---------------------------------------------------------------------------------- | ------ |
| 1.0  | 2025-11-25 | 초안 작성                                                                          | Claude |
| 1.1  | 2025-11-25 | 할일 완료 상태 추가, 관리자 역할 명확화, 요구사항 추적 ID 체계 도입,토큰 형식 결정 | Claude |

## 1. 프로젝트 개요

사용자 인증 기반의 개인 할일 관리 애플리케이션으로, 사용자별 할일 목록과 공통 국경일 일정을 통합 관리한다.

## 2. 도메인 모델

### 2.1 핵심 엔티티

#### User (사용자)

- 회원가입 및 인증 정보를 관리
- 개인 할일 목록의 소유자

**주요 속성:**

- userId: 사용자 고유 식별자
- email: 로그인 이메일
- password: 암호화된 비밀번호
- username: 사용자 이름
- role: 사용자 역할 (user, admin)

#### Todo (할일)

- 사용자별 개인 할일 항목
- 일정(시작/만료)과 내용 관리

**주요 속성:**

- todoId: 할일 고유 식별자
- userId: 소유자 식별자
- title: 할일 제목
- content: 할일 상세 내용
- startDate: 시작일
- dueDate: 만료일
- status: 상태 (active, completed, deleted)
- isCompleted: 완료 여부 (boolean)
- createdAt: 생성일시
- updatedAt: 수정일시
- deletedAt: 삭제일시 (소프트 삭제)

#### Holiday (공통 일정)

- 국경일 등 모든 사용자에게 공통으로 제공되는 일정
- 삭제 불가

**주요 속성:**

- holidayId: 공통 일정 고유 식별자
- title: 일정 제목
- date: 일정 날짜
- description: 설명
- isRecurring: 매년 반복 여부

### 2.2 엔티티 관계

```
User (1) --- (N) Todo
```

- 한 명의 사용자는 여러 개의 할일을 소유
- 할일은 반드시 한 명의 소유자를 가짐
- Holiday는 독립적으로 존재하며 모든 사용자가 조회 가능

## 3. 유스케이스

### 3.1 사용자 관리

- **[UC-01] 회원가입**: 새로운 사용자 계정 생성
- **[UC-02] 로그인**: 인증된 사용자의 세션 시작

### 3.2 할일 관리

- **[UC-03] 할일 조회**: 로그인한 사용자의 개인 할일 목록 조회 (활성 상태만)
- **[UC-04] 할일 추가**: 새로운 할일 생성 (제목, 내용, 시작일, 만료일)
- **[UC-05] 할일 수정**: 기존 할일의 일정 및 내용 변경
- **[UC-06] 할일 완료**: 할일을 완료 상태로 변경 (isCompleted=true, status='completed')
- **[UC-07] 할일 삭제**: 할일을 휴지통으로 이동 (소프트 삭제)
- **[UC-08] 할일 복원**: 휴지통에서 할일을 활성 상태로 복원

### 3.3 휴지통 관리

- **[UC-09] 휴지통 조회**: 삭제된 할일 목록 조회
- **[UC-10] 영구 삭제**: 휴지통의 할일을 완전히 삭제 (복구 불가)

### 3.4 공통 일정 조회

- **[UC-11] 국경일 조회**: 모든 사용자가 공통으로 볼 수 있는 국경일 일정 조회

## 4. 비즈니스 규칙

### 4.1 인증 및 권한

- **[BR-01]** 회원가입과 로그인을 제외한 모든 기능은 인증된 사용자만 접근 가능
- **[BR-02]** 일반 사용자(role='user')는 자신의 할일만 조회, 수정, 삭제 가능
- **[BR-03]** 공통 일정(국경일)은 모든 인증된 사용자가 조회 가능
- **[BR-04]** 관리자(role='admin')는 국경일(Holiday)의 추가/수정 권한 보유

### 4.2 할일 관리

- **[BR-05]** 할일 삭제 시 즉시 제거되지 않고 휴지통으로 이동 (status='deleted', deletedAt 기록)
- **[BR-06]** 휴지통의 할일은 복원 가능
- **[BR-07]** 휴지통에서 영구 삭제 시 데이터베이스에서 완전히 제거
- **[BR-08]** 할일 완료 시 isCompleted=true, status='completed'로 변경

### 4.3 공통 일정

- **[BR-09]** 국경일은 관리자만 추가/수정 가능 (사용자는 조회만 가능)
- **[BR-10]** 국경일은 삭제 불가
- **[BR-11]** 매년 반복되는 일정 지원

### 4.4 일정 관리

- **[BR-12]** 만료일(dueDate)은 시작일(startDate)과 같거나 이후여야 함
- **[BR-13]** 만료일이 지난 할일은 UI에서 시각적으로 구분

## 5. 제약사항

### 5.1 기술적 제약

- 비밀번호는 암호화하여 저장
- 삭제된 할일은 소프트 삭제 방식 사용 (복원 가능성 보장)
- 토큰(JWT) 기반 인증 방식 적용
- 토큰은 access_token, refresh_token을 함께 사용하도록 할 것

### 5.2 보안 제약

- 사용자는 타인의 할일에 접근 불가
- API 요청 시 사용자 인증 필수

### 5.3 데이터 제약

- 할일 제목은 필수 입력
- 이메일은 고유해야 함 (중복 불가)
- 만료일은 시작일 이전일 수 없음